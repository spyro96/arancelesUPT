!function(){const t=document.querySelectorAll(".rol"),e=document.querySelectorAll(".eliminar"),o=document.querySelector("#actualizar-usuario"),a=document.querySelector("#user-rol"),i=document.querySelector("#body-usuarios"),n=document.querySelectorAll(".estatusUsuario");document.querySelectorAll(".resetear-usuario").forEach(t=>{t.addEventListener("dblclick",e=>{e.preventDefault(),Swal.fire({title:"多Estas Seguro?",text:"多Estas seguro que quieres resetear este usuario?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si!",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&async function(t){const e=new FormData;e.append("id",t);try{const t=window.location.origin+"/api/resetPassword",o=await fetch(t,{method:"POST",body:e});"exito"===(await o.json()).resultado&&iziToast.success({title:"Usuario restablecido!",position:"topRight",timeout:3e3})}catch(t){console.log(t)}}(t.dataset.id)})})});const s={rol:"",usuarioId:"",rolActual:""};n.forEach(t=>{t.addEventListener("dblclick",e=>{const o=e.target.dataset.id,a=e.target,i="Activo"===a.textContent?"Inactivo":"Activo";t.classList.contains("activo")?(t.classList.remove("activo"),t.classList.add("inactivo")):(t.classList.remove("inactivo"),t.classList.add("activo")),async function(t,e,o){const a=new FormData;a.append("id",t),a.append("nuevoEstatus","Inactivo"===e?"0":"1");try{const t=window.location.origin+"/api/estatus-usuario",i=await fetch(t,{method:"POST",body:a});"exito"===(await i.json()).resultado&&(iziToast.success({title:"Actualizado",message:"Estatus Actualizado!",position:"topRight",timeout:3e3}),o.textContent=e)}catch(t){console.log(t)}}(o,i,a)})}),e.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),Swal.fire({title:"多Estas Seguro?",text:"多Estas seguro que quieres eliminar este usuario?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si!",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&async function(t,e){const o=new FormData;o.append("id",t);try{const t=window.location.origin+"/api/eliminar-usuario",a=await fetch(t,{method:"POST",body:o});"exito"===(await a.json()).resultado&&(Swal.fire({title:"Borrado!",text:"Data Eliminado.",icon:"success"}),i.removeChild(e))}catch(t){iziToast.error({title:"Opps",message:"Ha ocurrido un error!"})}}(t.dataset.iduser,t.parentNode.parentElement.parentElement)})})}),t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),s.usuarioId=parseInt(t.dataset.iduser),console.log(t.closest("tr").querySelector("td:nth-child(3)").textContent),s.rolActual=t.closest("tr").querySelector("td:nth-child(3)")})}),a.addEventListener("change",t=>{s.rol=t.target.value}),o.addEventListener("click",()=>{Object.values(s).includes("")?iziToast.error({title:"Debe seleccionar el rol",transitionIn:"fadeInUp",position:"topCenter"}):async function(t){const{usuarioId:e,rol:a,rolActual:i}=t,n=new FormData;n.append("usuarioId",e),n.append("rol",a),o.textContent="Enviando...",o.disabled=!0;try{const t=window.location.origin+"/api/usuario-rol",e=await fetch(t,{method:"POST",body:n}),s=await e.json();console.log(s),"exito"===s.resultado&&(iziToast.success({title:"Actualizado",message:"El rol del usuario ha sido actualizado!",position:"topRight",timeout:2500}),i.textContent=a,$("#staticBackdrop").modal("hide"),o.textContent="Actualizar",o.disabled=!1)}catch(t){iziToast.error({title:"Opps",message:"Ha ocurrido un error!"}),o.textContent="Actualizar",o.disabled=!1}}(s)})}();