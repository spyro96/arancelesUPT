!function(){const e={referencia:"",bancoEmisor:"",imagen:"imagen"},t=document.querySelector("#referencia"),a=document.querySelector(".referencia-bancaria"),n=document.querySelector("#campo-bancos"),r=document.querySelector("#bancos");let o=document.querySelector("#imagen"),i=document.querySelector("#mostrar-imagen");const c=document.querySelector(".formulario"),l=document.querySelector("#btn-enviar");c.addEventListener("submit",t=>{t.preventDefault(),function(){"P"===n.lastChild.nodeName&&n.lastChild.remove();if(""===e.bancoEmisor&&"P"!==n.lastChild.nodeName){const e=document.createElement("P");e.classList.add("banco-vacio"),e.textContent="Este Campo es obligatorio",n.appendChild(e)}if(""===e.referencia||e.referencia.length<4){if("P"!==a.lastChild.nodeName){const e=document.createElement("P");e.textContent="Debe de colocar al menos los 4 ultimos digitos de la referencia bancaria",a.appendChild(e)}return}if(Object.values(e).includes(""))return;!async function(){const{referencia:t,bancoEmisor:a,imagen:n}=e,r=function(){const e=new URL(window.location.href);return e.searchParams.get("estudiante")}(),o=new FormData;o.append("id",r),o.append("referencia",t),o.append("banco",a),o.append("bauche",n),l.value="Enviando...",l.disabled=!0;try{const e=window.location.origin+"/api/reportar-pago",t=await fetch(e,{method:"POST",body:o});"correcto"===(await t.json()).respuesta&&(l.value="Enviar",l.disabled=!1,Swal.fire({icon:"success",title:"Datos Enviados Correctamente!",button:"OK!"}).then(()=>{setTimeout(()=>{window.location.replace("/estudiante/solicitudes")},500)}))}catch(e){console.log(e),Swal.fire({icon:"error",title:"Error",text:"Opps, Ha ocurrido un error, vuelva a intentarlo!"}),l.value="Enviar",l.disabled=!1}}()}()}),o.addEventListener("change",()=>{let t=URL.createObjectURL(o.files[0]);i.setAttribute("src",t),e.imagen=o.files[0]}),r.addEventListener("change",t=>{e.bancoEmisor=t.target.value}),t.addEventListener("keypress",e=>{const t=e.target.value;/^[0-9]*$/.test(t)||(e.target.value=t.replace(/[^0-9]/g,""))}),t.addEventListener("input",t=>{t.target.value.length>8&&(t.target.value=t.target.value.slice(0,8),t.preventDefault()),e.referencia=t.target.value,console.log(e.referencia)})}();