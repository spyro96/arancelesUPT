!function(){const e=document.querySelector("#buscar"),t=document.querySelector("#correo"),n=document.querySelector(".auth"),a={id:"",respuesta1:"",respuesta2:""},s={password1:"",password2:"",usuarioId:"",elemento:""};function o(e){a[e.target.id]=e.target.value.trim()}function i(e){s[e.target.id]=e.target.value.trim()}e.addEventListener("submit",e=>{e.preventDefault();!async function(e){const a=new FormData;a.append("correo",e);const r=document.querySelector('input[type="submit"]');r.disabled=!0,r.value="Consultando...";try{const e=window.location.origin+"/api/preguntas",l=await fetch(e,{method:"POST",body:a}),d=await l.json();null===d.resultado?(iziToast.warning({title:"Usuario no existe",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter",displayMode:1}),setTimeout(()=>{r.disabled=!1,r.value="Consultar"},4500)):(s.usuarioId=d.preguntas.usuarioId,function(e){const{pregunta1:t,pregunta2:a,id:r}=e;s.idUsuario=e.usuarioId;const l=r,d=document.createElement("FORM");d.classList.add("contenido"),d.id="formulario",d.innerHTML=`\n            <div class="formulario-preguntas">\n                <div class="campo">\n                    <label>Pregunta 1</label>\n                    <input type="text" disabled value="${t}">\n                </div>\n                <div class="campo">\n                    <label>Respuesta 1</label>\n                    <input type="text" id="respuesta1">\n                </div>\n                <div class="campo">\n                    <label>Pregunta 2</label>\n                    <input type="text" disabled value="${a}">\n                </div>\n                <div class="campo">\n                    <label>Respuesta 2</label>\n                    <input type="text" id="respuesta2">\n                </div>\n            </div>\n\n            <div class="contenedorBoton">\n                <button type="submit" id="botonEnviarRespuesta" disbled>Enviar</button>\n            </div>\n        `,document.querySelector("#contenedor-preguntas").appendChild(d),setTimeout(()=>{document.querySelector("#formulario"),document.querySelector("#respuesta1"),document.querySelector("#respuesta2")},0),respuesta1.addEventListener("input",o),respuesta2.addEventListener("input",o),botonEnviarRespuesta.addEventListener("click",e=>{e.preventDefault(),""!==respuesta1.value&&""!==respuesta2.value?async function(e,t,a,o){const r=new FormData;r.append("respuesta1",e),r.append("respuesta2",t),r.append("id",a),o.disabled=!0;try{const e=window.location.origin+"/api/comprobar-preguntas",t=await fetch(e,{method:"POST",body:r});if("correcto"!==await t.json())return iziToast.warning({title:"respuestas incorrectas, intente nuevamente",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter",displayMode:1}),void(o.disabled=!1);!function(){const e=document.querySelector("#contenedor-preguntas");for(;e.firstChild;)e.removeChild(e.firstChild);n.removeChild(document.querySelector(".parrafo")),n.removeChild(document.querySelector(".formulario-olvide"));const t=document.createElement("FORM");t.classList.add("contenido"),t.id="formulario",t.innerHTML='\n        <div class="formulario-preguntas">\n            <div class="campo campo-password">\n                <label>Contraseña Nueva</label>\n                <input type="password" id="password1">\n                <i class="fa-solid fa-eye" id="icono1"></i>\n                <ul class="lista-requerimiento">\n                    <li>\n                        <i class="fa-solid fa-circle"></i>\n                        <span>La contraseña debe contener al menos 6 caracteres</span>\n                    </li>\n                    <li>\n                        <i class="fa-solid fa-circle"></i>\n                        <span>Al menos una letra minuscula [a-z]</span>\n                    </li>\n                    <li>\n                        <i class="fa-solid fa-circle"></i>\n                        <span>Al menos una letra mayuscula [A-Z]</span>\n                    </li>\n                    <li>\n                        <i class="fa-solid fa-circle"></i>\n                        <span>Al menos un numero [0-9]</span>\n                    </li>\n                </ul>\n            </div>\n            <div class="campo campo-repetido">\n                <label>Repetir Contraseña</label>\n                <input type="password" id="password2">\n                <i class="fa-solid fa-eye" id="icono2"></i>\n            </div>\n        </div>\n\n        <div class="contenedorBoton">\n                <button type="submit" id="botonPassword">Enviar</button>\n        </div>\n        ',document.querySelector("#contenedor-password").appendChild(t);const a=document.querySelector("#icono1"),o=document.querySelector("#icono2"),r=[{regex:/.{6,}/,index:0},{regex:/[a-z]/,index:1},{regex:/[A-Z]/,index:2},{regex:/[0-9]/,index:3}],l={password:!1};setTimeout(()=>{document.querySelector("#formulario"),document.querySelector("password1"),document.querySelector("password2");s.elemento=document.querySelector("#botonPassword"),iziToast.warning({title:"las contraseñas deben tener al menos 6 caracteres",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter"})},2),a.addEventListener("click",()=>{a.classList.toggle("fa-fade"),"password"===password1.type?password1.type="text":password1.type="password"}),o.addEventListener("click",()=>{o.classList.toggle("fa-fade"),"password"===password2.type?password2.type="text":password2.type="password"});const d=document.querySelectorAll(".lista-requerimiento li");password1.addEventListener("input",e=>{l.password=function(e){const t=/[A-Z]/.test(e),n=/[a-z]/.test(e),a=/\d/.test(e);return t&&n&&a}(e.target.value),s[e.target.id]=e.target.value.trim(),r.forEach(t=>{const n=t.regex.test(e.target.value),a=d[t.index];n?(a.classList.add("valido"),a.firstElementChild.className="fa-solid fa-check"):(a.classList.remove("valido"),a.firstElementChild.className="fa-solid fa-circle")})}),password2.addEventListener("input",i),formulario.addEventListener("submit",e=>{e.preventDefault(),Object.values(s).includes("")?iziToast.warning({title:"los campos no pueden ir vacios",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter"}):!1!==l.password?s.password1===s.password2?async function(){const{password1:e,password2:t,usuarioId:n,elemento:a}=s,o=new FormData;o.append("password",e),o.append("id",n),a.disabled=!0;try{const e=window.location.origin+"/api/actualizar-password",t=await fetch(e,{method:"POST",body:o});"exito"===(await t.json()).resultado&&(Swal.fire({title:"Contraseña Actualizada!",text:"Su contraseña ha sido actualizada!",icon:"success"}),document.querySelector("#botonPassword").value="Listo",setTimeout(()=>{window.location.replace("/")},2e3))}catch(e){Swal.fire({icon:"error",title:"Oops...",text:"algo salio mal, intente nuevamente!"}),setTimeout(()=>{a.disabled=!1},2e3)}}():iziToast.warning({title:"Las contraseñas no coinciden",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter"}):iziToast.warning({title:"La contraseña no cumple con los requisitos",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter"})})}()}catch(e){console.log(e)}}(respuesta1.value,respuesta2.value,l,botonEnviarRespuesta):iziToast.warning({title:"Las respuesta no pueden ir vacias",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter",displayMode:1})})}(d.preguntas),r.value="Listo",t.disabled=!0,setTimeout(()=>{r.remove()},2e3))}catch(e){console.log(e)}}(t.value)})}();