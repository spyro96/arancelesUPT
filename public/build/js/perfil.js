!function(){const e=document.querySelector("#passwordActual"),t=document.querySelector("#passwordNuevo"),a=document.querySelector("#icono"),r=document.querySelector("#formulario-password"),o=document.querySelector("#formulario-preguntas"),s=document.querySelectorAll(".lista-requerimiento li"),n=document.querySelector("#id-usuario"),i=document.querySelector("#pregunta1"),u=document.querySelector("#respuesta1"),d=document.querySelector("#pregunta2"),c=document.querySelector("#respuesta2");i.addEventListener("change",m),u.addEventListener("input",m),d.addEventListener("change",m),c.addEventListener("input",m);const l={id:n.value,passwordActual:"",passwordNuevo:"",validacion:""},p={id:n.value,pregunta1:"",respuesta1:"",pregunta2:"",respuesta2:""},v=[{regex:/.{6,}/,index:0},{regex:/[a-z]/,index:1},{regex:/[A-Z]/,index:2},{regex:/[0-9]/,index:3}];function m(e){p[e.target.id]=e.target.value.trim()}function g(e){l[e.target.id]=e.target.value,"passwordNuevo"===e.target.id&&(l.validacion=function(e){const t=/[A-Z]/.test(e),a=/[a-z]/.test(e),r=/\d/.test(e);return t&&a&&r}(e.target.value),v.forEach(t=>{const a=t.regex.test(e.target.value),r=s[t.index];a?(r.classList.add("valido"),r.firstElementChild.className="fa-solid fa-check"):(r.classList.remove("valido"),r.firstElementChild.className="fa-solid fa-circle")}))}e.addEventListener("input",g),t.addEventListener("input",g),r.addEventListener("submit",e=>{e.preventDefault(),!1!==l.validacion?Object.values(l).includes("")||!0!==l.validacion||async function(){const{id:e,passwordActual:t,passwordNuevo:a}=l,r=new FormData;r.append("id",e),r.append("passwordActual",t),r.append("passwordNuevo",a);const o=document.querySelector("#btnPassword");o.value="Enviando",o.disabled=!0;try{const e=window.location.origin+"/api/cambiar-passsword",t=await fetch(e,{method:"POST",body:r}),a=await t.json();if(console.log(a),"incorrecto"===a.resultado)return Swal.fire({icon:"error",title:"Opps!",text:"La contraseña actual es incorrecto, intente nuevamente!",button:"OK!"}),o.setAttribute("value","Enviar"),void(o.disabled=!1);"exito"===a.resultado&&(Swal.fire({icon:"success",title:"Datos Actualizados!",text:"Datos Actualizados Correctamente!",button:"OK!"}),o.value="Listo")}catch(e){Swal.fire({icon:"error",title:"Error",text:"Opps, Ha ocurrido un error, vuelva a intentarlo!"}),o.setAttribute("value","Enviar"),o.disabled=!1}}():iziToast.error({title:"Error",message:"La nueva contraseña no cumple con los requisitos",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter",displayMode:1})}),o.addEventListener("submit",e=>{e.preventDefault(),function(){const e={respuesta1:3,respuesta2:3};document.querySelectorAll(".campo-respuesta input").forEach(t=>{const a=t.getAttribute("name");if(t.value.length<e[a])return t.classList.add("campos-faltantes"),void iziToast.error({title:"Las respuestas no pueden ir vacias y con minimo de 3 caracteres",transitionIn:"flipInX",transitionOut:"flipOutX",position:"topCenter",displayMode:1});t.classList.remove("campos-faltantes")})}(),!Object.values(p).includes("")&&p.respuesta1.length>=3&&p.respuesta2.length>=3&&async function(){const{id:e,pregunta1:t,respuesta1:a,pregunta2:r,respuesta2:o}=p,s=new FormData;s.append("usuarioId",e),s.append("pregunta1",t),s.append("pregunta2",r),s.append("respuesta1",a),s.append("respuesta2",o);const n=document.querySelector('.submit-preguntas input[type="submit"]');n.disabled=!0,n.value="Actualizando";try{const e=window.location.origin+"/api/actualizar-preguntas",t=await fetch(e,{method:"POST",body:s});"exito"===(await t.json()).resultado&&(Swal.fire({icon:"success",title:"Datos Actualizados!",text:"Datos Actualizados Correctamente!",button:"OK!"}),n.value="Listo",document.querySelector("#pregunta1").disabled=!0,document.querySelector("#pregunta2").disabled=!0,document.querySelector("#respuesta1").disabled=!0,document.querySelector("#respuesta2").disabled=!0)}catch(e){Swal.fire({icon:"error",title:"Error",text:"Opps, Ha ocurrido un error, vuelva a intentarlo!"}),n.disabled=!1,n.value="Actualizar Preguntas"}}()}),a.addEventListener("click",()=>{a.classList.toggle("fa-fade"),"password"===t.type?t.type="text":t.type="password"})}();